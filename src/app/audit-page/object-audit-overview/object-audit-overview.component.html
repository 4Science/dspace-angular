<div class="container">
  <div class="d-flex">
    <h2 class="flex-grow-1">{{'audit.object.overview.title' | translate}}</h2>
  </div>

  @if (object) {
    <h4 class="mt-4 mb-4">{{ object.name }} (<em>{{object.type}}</em>)</h4>
    @if ((auditsRD$ | async)?.payload; as audits) {
      @if (audits.totalElements === 0) {
        <div>
          No audits found.
        </div>
      }

      @if (audits.totalElements > 0) {
        <ds-pagination
          [paginationOptions]="pageConfig"
          [collectionSize]="audits.totalElements"
          [hideGear]="true"
          [hidePagerWhenSinglePage]="true">

          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th>{{ 'audit.overview.table.id' | translate }}</th>
                  <th>{{ 'audit.overview.table.entityType' | translate }}</th>
                  <th>{{ 'audit.overview.table.eperson' | translate }}</th>
                  <th>{{ 'audit.overview.table.timestamp' | translate }}</th>
                  <th>{{ 'audit.overview.table.other' | translate }}</th>
                </tr>
              </thead>
              <tbody>
                @for (audit of audits.page; track audit) {
                  <tr>
                    <td><a [routerLink]="['/auditlogs/', audit.id]">{{audit.id}}</a></td>
                    <td>{{ audit.eventType }}</td>
                    <td>{{ audit.epersonName }}</td>
                    <td>{{ audit.timeStamp | date:dateFormat}}</td>
                    <td>
                      @if (object.id === audit.objectUUID) {
                        <span>
                          @if (audit.otherAuditObject; as dso) {
                            {{ dsoNameService.getName(dso) }} <em>({{ dso.type }})</em>
                          } @else {
                            {{ dataNotAvailable }}
                          }
                        </span>
                      } @else {
                        {{ dataNotAvailable }}
                      }
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </ds-pagination>
      }
      <a class="btn btn-light mt-3" [routerLink]="['/items', object.id]"><i class="fas fa-arrow-left"></i> Back to Item</a>
    }
    @if ((auditsRD$ | async)?.statusCode === 404) {
      <h4 class="mt-4 mb-4">{{'audit.object.overview.disabled.message' | translate}}</h4>
    }
  }

</div>
